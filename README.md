# Note.com AI Writer (Multi-Genre Report)

> **NoteのセッションCookieの取得方法**:
> 1. ブラウザで [note.com](https://note.com) にログインします。
> 2. F12キーを押して開発者ツールを開きます。
> 3. 「アプリケーション (Application)」タブ → 「Cookie」を選択します。
> 4. `https://note.com` を選択し、名前が `session` の値（長い文字列）をコピーしてください。

## 使い方
設定完了後、もう一度 `run.bat` をダブルクリックしてください。

1. ニュースの収集が始まります。
2. AIがレポートを作成します。
3. Note.comに「YYYY-MM-DD 簡単レポート」というタイトルで下書き保存されます。
4. 完了すると、作成された記事のURLが表示されます。

## 注意事項
- アカウントの安全のため、まずは `upload_status: "draft"`（下書き）での運用を推奨します。

## 実運用（自動化）について

このプログラムは**常駐型**として動作するように設計されています。
# Note.com AI Writer (Multi-Genre Report)

> **NoteのセッションCookieの取得方法**:
> 1. ブラウザで [note.com](https://note.com) にログインします。
> 2. F12キーを押して開発者ツールを開きます。
> 3. 「アプリケーション (Application)」タブ → 「Cookie」を選択します。
> 4. `https://note.com` を選択し、名前が `session` の値（長い文字列）をコピーしてください。

## 使い方
設定完了後、もう一度 `run.bat` をダブルクリックしてください。

1. ニュースの収集が始まります。
2. AIがレポートを作成します。
3. Note.comに「YYYY-MM-DD 簡単レポート」というタイトルで下書き保存されます。
4. 完了すると、作成された記事のURLが表示されます。

## 注意事項
- アカウントの安全のため、まずは `upload_status: "draft"`（下書き）での運用を推奨します。

## 実運用（自動化）について

このプログラムは**常駐型**として動作するように設計されています。
起動すると、以下のタイミングで自動的に記事を作成・投稿します。

1. **起動直後**
2. **毎日 08:00**
3. **毎日 20:00**

### 4. 見出し画像 (Eyecatch)
- **AI画像生成 (New!)**: `config.yaml` で `image_generation: enabled: true` に設定すると、記事の内容に合わせてAI (Stable Diffusion) が画像を自動生成します。
    - **設定変更**: `config.yaml` でモデル(`model_id`)、解像度(`width`, `height`)、ステップ数(`steps`)を変更できます。
    - **デバイス設定**: `device: "cuda"` にするとNVIDIA GPUを使用します（高速）。Intel N100などの場合は `"cpu"` にしてください。
    - **カスタムモデル**: `model_id` には Hugging FaceのID (例: `runwayml/stable-diffusion-v1-5`) または、ローカルのDiffusers形式のモデルフォルダパスを指定できます。
    - **⚠️ Intel N100での注意**: 
        - デフォルト(512x512)で数分かかります。
        - **高解像度 (例: 1920x1006) に設定すると、生成に30分以上かかったり、メモリ不足で停止する可能性があります。**
        - 動作が重い場合は、解像度を下げるか、ステップ数を減らしてください(例: 20)。
    - **モデルの追加 (Shiitake Mixなど)**:
        1. `download_model.py` を実行してモデルをダウンロードします（または手動で `models` フォルダに配置）。
        2. `config.yaml` の `model_id` を `models/ShiitakeMix.safetensors` に変更します（`models/` フォルダからの相対パス推奨）。
    - **プロンプト設定**:
        - `config.yaml` の `prompts` リストに複数のプロンプトを設定すると、その中からランダムに選ばれます。
        - `use_article_context: true` にすると、記事の内容から生成されたキーワードが追加されます。
- **ランダム選択**: 画像生成が無効、または失敗した場合、`eyecatch` フォルダ内の画像からランダムに選択されます。
- **固定画像**: 上記のいずれも利用できない場合、ルートディレクトリの `eyecatch.png` が使用されます。

### 5. 検索機能の切り替え (New!)
`config.yaml` の `use_search` でGoogle検索の有無を切り替えられます。
- `true`: 最新ニュースを検索してレポートを作成（デフォルト）。
- `false`: 検索を行わず、AIの知識のみでエッセイやコラムを作成。

### 6. トラブルシューティング
- **インストールが止まる**: 初回実行時、`antlr4-python3-runtime` や `torch` のインストールで数分〜10分程度止まったように見えることがありますが、裏で処理が進んでいます。エラーが出ない限り画面を閉じずに待ってください。
- **画像生成が遅い**: Intel N100等のCPUでは、1枚の生成に数分かかります。`config.yaml` で `width`, `height` を小さくする（例: 512x512）と改善します。

### 5. 実行
```bash
run.bat
``` の `upload_status` を変更すると、下書きではなく即時公開されます。

```yaml
# draft（下書き）または published（公開）
upload_status: "published"
```

### 使い方
1. `run.bat` をダブルクリックして起動します。
2. 黒い画面（コマンドプロンプト）が開いたままになります。**この画面を閉じないでください。**
3. PCをつけっぱなしにしておけば、指定の時間に自動で処理が行われます。

### 自動公開設定
`config.yaml` の `upload_status` を変更すると、下書きではなく即時公開されます。

```yaml
# draft（下書き）または published（公開）
upload_status: "published"
```
